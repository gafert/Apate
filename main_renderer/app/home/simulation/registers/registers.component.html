<div class="grid-container">
  <div class="grid-container--header">Registers</div>
  <div class="grid-container--content">
    <table class="reg-table">
      <tr>
        <th style="width: 20%">
          Signal
        </th>
        <th style="width: 10%">
          No.
        </th>
        <th style="width: 15%">
          Name
        </th>
        <th style="width: 30%">
          Hex
        </th>
        <th style="width: 10%">
          ASCII
        </th>
      </tr>
      <ng-container *ngFor="let item of [].constructor(32); let i = index">
        <ng-container *ngTemplateOutlet="(cpuInterface.bindings.rd.value == i ||
                      cpuInterface.bindings.rs1addr.value == i ||
                      cpuInterface.bindings.rs2addr.value == i) ? hasActiveRegister : hasNoActiveRegister; context: { i: i, rd: cpuInterface.bindings.rd.value == i, rs1: cpuInterface.bindings.rs1addr.value == i , rs2: cpuInterface.bindings.rs2addr.value == i  }">
        </ng-container>
      </ng-container>
    </table>
  </div>
</div>

<ng-template #hasActiveRegister let-i="i" let-rd="rd" let-rs1="rs1" let-rs2="rs2">
  <tr [class.active-reg-rs1]="rs1" [class.active-reg-rs2]="rs2" [class.active-reg-rd]="rd" >
    <td>
      <span *ngIf="rd && !rs2 && !rs1" tippy [tippyOptions]="{content: 'Return Address'}">RD</span>
      <span *ngIf="rd && !rs2 && rs1" tippy [tippyOptions]="{content: 'Return Address and Source Register 1'}">RD/RS1</span>
      <span *ngIf="rd && rs2 && rs1" tippy [tippyOptions]="{content: 'Return Address and Source Register 2'}">RD/RS2</span>
      <span *ngIf="!rd && !rs2 && rs1" tippy [tippyOptions]="{content: 'Source Register 1'}">RS1</span>
      <span *ngIf="!rd && rs2 && !rs1" tippy [tippyOptions]="{content: 'Source Register 2'}">RS2</span>
      <span *ngIf="!rd && rs2 && rs1" tippy [tippyOptions]="{content: 'Source Register 1 and Source Register 1'}">RS1/RS2</span>
      <span *ngIf="rd && rs2 && rs1" tippy [tippyOptions]="{content: 'Return Address, Source Register 2 and Source Register 1'}">RD/RS1/RS2</span>
    </td>
    <ng-container *ngTemplateOutlet="line; context: { i: i }"></ng-container>
  </tr>
</ng-template>

<ng-template #hasNoActiveRegister let-i="i">
  <tr>
    <td></td>
    <ng-container *ngTemplateOutlet="line; context: { i: i }"></ng-container>
  </tr>
</ng-template>

<ng-template #line let-i="i">
  <!-- Tooltip HTMLs -->
  <div style="display: none" [id]="'tippyRegisterValue-' + i">
    as hex: {{byteToHex(cpuInterface.bindings.cpuregs.value[i], 2)}}<br>
    as decimal: {{cpuInterface.bindings.cpuregs.value[i]}}<br>
    as ASCII: {{fromCharCode(cpuInterface.bindings.cpuregs.value[i])}}
  </div>
  <div style="display: none" [id]="'tippyRegisterName-' + i">
    <strong>{{cpuRegDefinitions[i][1]}}</strong><br>
    short: {{cpuRegDefinitions[i][0]}}
  </div>

  <td>
    <div class="text-rounded-container grey1" tippy [tippyOptions]="{tippyElementId: 'tippyRegisterName-' + i}">{{i}}</div>
  </td>
  <td>
    <span tippy [tippyOptions]="{tippyElementId: 'tippyRegisterName-' + i}">{{cpuRegDefinitions[i][0]}}</span>
  </td>
  <td>
    <span tippy [tippyOptions]="{tippyElementId: 'tippyRegisterValue-' + i}">{{byteToHex(cpuInterface.bindings.cpuregs.value[i], 2)}}</span>
  </td>
  <td>
    <span tippy [tippyOptions]="{tippyElementId: 'tippyRegisterValue-' + i}">{{fromCharCode(cpuInterface.bindings.cpuregs.value[i])}}</span>
  </td>
</ng-template>


